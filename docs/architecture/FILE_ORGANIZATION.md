# File Organization Guide

This document explains the purpose and organization of all project files.

## Essential Files (Keep)

### Configuration Files

- **`pyproject.toml`** - Python project configuration (ruff, mypy, pytest settings)
- **`.pre-commit-config.yaml`** - Pre-commit hooks configuration
- **`alembic.ini`** - Database migration configuration
- **`Dockerfile`** - Docker image build configuration
- **`docker-compose.yml`** - Development Docker Compose
- **`docker-compose.test.yml`** - Test Docker Compose
- **`docker-compose.prod.yml`** - Production Docker Compose
- **`.dockerignore`** - Files excluded from Docker builds
- **`.gitignore`** - Files excluded from Git version control

### Dependency Files

- **`requirements.in`** - **Source file** for pip-tools (unpinned top-level dependencies)
- **`requirements.txt`** - **Generated file** from `requirements.in` (pinned with all transitive deps)
- **`requirements-dev.txt`** - Development-only dependencies (not for production)

**Note:** `requirements.txt` should be generated from `requirements.in` using `pip-compile`. If it's not locked yet, see [Dependency Locking](#dependency-locking).

### Documentation

- **`README.md`** - Main project documentation
- **`LICENSE`** - MIT License
- **`docs/`** - Additional documentation
  - `ops_runbook.md` - Operations and troubleshooting guide
  - `QUALITY_AUDIT.md` - Quality audit report
  - `DEVELOPMENT_SUMMARY.md` - Development summary

### Build & Automation

- **`Makefile`** - Common commands (build, test, migrate, etc.)
- **`VERSION`** - Current version number (used by release scripts)

### Source Code

- **`app/`** - Application source code
- **`tests/`** - Test files
- **`migrations/`** - Database migration scripts
- **`scripts/`** - Utility scripts (version bumping, releases)

## Redundant Files (Can Remove)

### `pytest.ini` - ⚠️ **REDUNDANT**

**Status:** Config is now in `pyproject.toml` (modern Python standard)

**Action:** Can be deleted. Pytest will read from `pyproject.toml` instead.

**Note:** `pyproject.toml` now includes all settings from `pytest.ini` including `--strict-markers` and `asyncio_mode`.

## Generated Files (Should Be Ignored)

These files are **generated by tools** and should NOT be committed:

- ❌ `bandit-findings.json` - Security scan output
- ❌ `mypy-findings.txt` - Type check output
- ❌ `pip-audit-findings.json` - Dependency audit output
- ❌ `ruff-findings.txt` - Linter output
- ❌ `ruff-baseline.json` - Linter baseline (empty)

**Action:** These are now in `.gitignore`. You can delete them from the repository:

```bash
# Remove from repo (they'll still be ignored)
git rm bandit-findings.json mypy-findings.txt pip-audit-findings.json ruff-findings.txt ruff-baseline.json
```

## Dependency Locking Strategy

### Current State

- **`requirements.in`** - Source file (unpinned dependencies) ✅
- **`requirements.txt`** - Currently **NOT locked** (should be generated from `.in`)

### Recommended Workflow

1. **Add dependencies:** Edit `requirements.in` (top-level, unpinned)
2. **Generate locked file:**
   ```bash
   pip-compile requirements.in
   ```
   This generates `requirements.txt` with all transitive dependencies pinned.

3. **In production:** Install from locked `requirements.txt`:
   ```bash
   pip install -r requirements.txt
   ```

4. **To upgrade:**
   ```bash
   pip-compile --upgrade requirements.in        # All packages
   pip-compile --upgrade-package fastapi requirements.in  # Specific package
   ```

### Next Steps

1. Run `pip-compile requirements.in` to generate locked `requirements.txt`
2. Review the generated `requirements.txt`
3. Commit both `requirements.in` and `requirements.txt`
4. Update CI/CD to use `requirements.txt` (not `requirements.in`)

## File Count Summary

**Total Essential Files:** ~20-25 files (excluding source code)  
**Can Remove:** 1 file (`pytest.ini`)  
**Should Ignore:** 5 files (findings outputs)  

## Questions?

- **Why multiple requirements files?** 
  - `requirements.in` = source (unpinned, editable)
  - `requirements.txt` = locked (generated, reproducible)
  - `requirements-dev.txt` = dev-only tools (not for production)

- **Why both `pytest.ini` and `pyproject.toml`?**
  - You don't need both. `pyproject.toml` is the modern standard. Config has been consolidated.

- **Should I commit generated files?**
  - Yes, for `requirements.txt` (needed for reproducible builds)
  - No, for `*-findings.*` files (tool output, regeneratable)
